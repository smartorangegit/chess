function showFlorPlan(){$(".entrance-flats").hover(function(){var t=$(this).offset().top,e=$(this).closest(".result-tile").offset().top,a=t-e-3,r=$(this).data();$(".floor-plan").css({top:a,display:"block"}),$(".floor-plan__link").attr("href",r)},function(){$(".floor-plan").css("display","none")}),$(".floor-plan").hover(function(){$(this).css("display","block")},function(){$(this).css("display","none")})}function showFilterPagination(){$(".result-tile-wrap").hasClass("result-tile_active-js")?$(".filter-pagination").css("display","none"):$(".filter-pagination").css("display","block")}function tooltipShow(){$(".entrance-flats__item").hover(function(){var t=$(".result-tile-wrap").offset().top,e=$(".result-tile-wrap").offset().left,a=$(this).offset().top,r=$(this).offset().left,l=a-t,o=r-e,n=$(".entrance-tooltip"),s=n.height(),i=n.width();$(this).hasClass("entrance-flats__item_not_available")||(n.css({top:l-s-25,left:o-1.4*i,opacity:"1"}),$(".entrance-tooltip__num").html($(this).data("num")),$(".entrance-tooltip__price").html($(this).data("price")),$(".entrance-tooltip__square").html($(this).data("square")),$(".entrance-tooltip__price_meter").html($(this).data("price_m")),$(".entrance-tooltip__rooms").html($(this).data("rooms")),$(".entrance-tooltip__image").attr("src",$(this).data("image")))},function(){$(".entrance-tooltip").css({opacity:"0",left:"-999px"})})}function addNewOptionToFilter(t,e){t.option.properties[e]=getDefaulValue($("input[name='"+e+"']"))}function rangeMarkup(t,e,a,r,l){return"<div id='"+t+"' class='range__item'><span class='filter_name'>"+a+"</span ><div class='filter__ranges filter__ranges_ta'><input name='"+e+"' type='range' min='"+r+"' max='"+l+"' class='filter__hidden-values js-filter__hidden-values' style='display: none;'><input class='filter__range js-filter__range'  type='text'><span class='range__text range__text_min js-filter__text_min'></span><span class='range__text range__text_max js-filter__text_max'></span></div></div>"}function getFlats(t){var e=[];for(var a in t){var r=t[a];e.push(r)}return e}function flatsShow(t){function e(t){switch(t.sale){case"1":return"<li class='result-plan-list__item'><a href='"+t.url+"' class='result-plan-list__image-link'><img src='"+t.img+"' alt='plan-image' class='result-plan-list__image'><div class='result-plan-info'><div class='result-plan-info__price'><p class='result-plan-info__text'>"+t.price+" грн</p><p class='result-plan-info__text'>"+t.all_room+"м<sup>2</sup> – "+t.price_m2+" грн/м<sup>2</sup></p><div class='color-box result-plan__color-box color-box_green'></div></div><div class='result-plan-info__floor'><p class='result-plan-info__text'>"+t.floor+" этаж</p><p class='result-plan-info__text'>№ "+t.number+"</p></div></div><span class='rooms__link result-plan__rooms'>"+t.rooms+"K</span><span class='button result-plan__button border-gradient'>Подробнее</span></a></li>";case"2":return"<li class='result-plan-list__item'><a href='"+t.url+"' class='result-plan-list__image-link'><img src='"+t.img+"' alt='plan-image' class='result-plan-list__image'><div class='result-plan-info'><div class='result-plan-info__price'><p class='result-plan-info__text'>Бронь</p><p class='result-plan-info__text'>"+t.all_room+"м<sup>2</sup></p><div class='color-box result-plan__color-box color-box_yellow'></div></div><div class='result-plan-info__floor'><p class='result-plan-info__text'>"+t.floor+" этаж</p><p class='result-plan-info__text'>№ "+t.number+"</p></div></div><span class='rooms__link result-plan__rooms'>"+t.rooms+"K</span><p class='result-plan-info__text result-plan-info__text_center'>Помещение недоступно для покупки</p></a></li>";case"3":return"<li class='result-plan-list__item'><a href='"+t.url+"' class='result-plan-list__image-link'><img src='"+t.img+"' alt='plan-image' class='result-plan-list__image'><div class='result-plan-info'><div class='result-plan-info__price'><p class='result-plan-info__text'>"+t.price+" грн</p><p class='result-plan-info__text'>"+t.all_room+"м<sup>2</sup> – "+t.price_m2+" грн/м<sup>2</sup></p><div class='color-box result-plan__color-box color-box_gray'></div></div><div class='result-plan-info__floor'><p class='result-plan-info__text'>"+t.floor+" этаж</p><p class='result-plan-info__text'>№ "+t.number+"</p></div></div><span class='rooms__link result-plan__rooms'>"+t.rooms+"K</span><span class='button result-plan__button border-gradient'>Подробнее</span></a></li>";case"0":default:return"<li class='result-plan-list__item'><a href='"+t.url+"' class='result-plan-list__image-link'><img src='"+t.img+"' alt='plan-image' class='result-plan-list__image'><div class='result-plan-info'><div class='result-plan-info__price'><p class='result-plan-info__text'>"+t.price+" грн</p><p class='result-plan-info__text'>"+t.all_room+"м<sup>2</sup> – "+t.price_m2+" грн/м<sup>2</sup></p><div class='color-box result-plan__color-box color-box_dark-gray'></div></div><div class='result-plan-info__floor'><p class='result-plan-info__text'>"+t.floor+" этаж</p><p class='result-plan-info__text'>№ "+t.number+"</p></div></div><span class='rooms__link result-plan__rooms'>"+t.rooms+"K</span><span class='button result-plan__button border-gradient'>Подробнее</span></a></li>"}}$(".result-plan-list__item").remove();var a=getFlats(t);return $(".result-plan-list").append(function(t){var a="";return t.forEach(function(t,r){a+=e(t)}),a}(a))}function selectHandler(){var t=document.getElementById("select_pagination").value;filter.count=t,$.ajax({url:"http://apivime.smarto.com.ua/ajax",type:"POST",dataType:"json",data:filter,success:function(t){console.log(t),flatsShowTable(t.dataList,t.dataTable),paginationItemShow(t.quantity,flatsShow,flatsShowTable)},error:function(t){console.log(t)}})}function flatsShowTable(t,e){function a(t){switch(t){case"1":return"<div class='color-box color-box_green filter-table__color-box'></div>";case"2":return"<div class='color-box color-box_yellow filter-table__color-box'></div>";case"3":return"<div class='color-box color-box_gray filter-table__color-box'></div>";case"0":return"<div class='color-box color-box_dark-gray filter-table__color-box'></div>";default:return"<div class='color-box filter-table__color-box'></div>"}}var r=getFlats(t);return $(".filter-table__head").append(function(t){$(".filter-table__heading").remove();var e="";return t.forEach(function(t,a){e+="<th data-sort='"+t[1]+"' class='filter-table__heading'>"+t[0]+"</th>"}),e}(e)),sendSortingData(),$(".filter-table__body").append(function(t,e){function r(t){for(var e in t.properties)t[e]=t.properties[e].property_flat;o.push(t)}$(".filter-table__row").remove();var l={},o=[],n="";return function(t){t.forEach(function(t){l[t[1]]=t[0]})}(e),t.forEach(r),o.forEach(function(t,e){var r="<tr onclick='location.href=&apos;http://apivime.smarto.com.ua"+t.url+"&apos;' class='filter-table__row'><td class='filter-table__col'>"+t.floor+"</td><td class='filter-table__col'>"+a(t.sale)+"</td><td class='filter-table__col'>"+t.life_room+"</td>";for(var o in l)"floor"!==o&&"sale"!==o&&"life_room"!==o&&(r+="<td class='filter-table__col'>"+(void 0!=t[o]?t[o]:"Нет значения")+"</td>");r+="</tr>",n+=r}),n}(r,e))}function sendSortingData(){$(".filter-table__heading").on("click",function(){$(this).toggleClass("filter-sort_top");var t=$(this).data("sort");filter.order=tableHeadingCklickCount%2==0?[t,"asc"]:[t,"desc"],tableHeadingCklickCount++,$.ajax({url:"http://apivime.smarto.com.ua/ajax",type:"POST",dataType:"json",data:filter,success:function(t){console.log(t),flatsShowTable(t.dataList,t.dataTable),paginationItemShow(t.quantity,flatsShow,flatsShowTable)},error:function(t){console.log(t)}})})}function entranceShow(t){function e(t){function e(e,a){switch(e.sale){case"1":return"<li class='"+a+"'data-image='"+t.img+"'data-square='"+t.all_room+"'data-price_m='"+t.price_m2+"'data-price='"+t.price+"'data-rooms='"+t.rooms+"'data-num='"+t.number+"'><a href='"+t.url+"' class='entrance-flats__color-box color-box_green'>"+t.rooms+"</a></li>";case"2":return"<li class='"+a+"'data-image='"+t.img+"'data-square='"+t.all_room+"'data-price_m='"+t.price_m2+"'data-price='"+t.price+"'data-rooms='"+t.rooms+"'data-num='"+t.number+"'><a href='"+t.url+"' class='entrance-flats__color-box color-box_yellow'>"+t.rooms+"</a></li>";case"3":return"<li class='"+a+"'data-image='"+t.img+"'data-square='"+t.all_room+"'data-price_m='"+t.price_m2+"'data-price='"+t.price+"'data-rooms='"+t.rooms+"'data-num='"+t.number+"'><a href='"+t.url+"' class='entrance-flats__color-box color-box_gray'>"+t.rooms+"</a></li>";case"0":return"<li class='"+a+"'data-image='"+t.img+"'data-square='"+t.all_room+"'data-price_m='"+t.price_m2+"'data-price='"+t.price+"'data-rooms='"+t.rooms+"'data-num='"+t.number+"'><a href='"+t.url+"' class='entrance-flats__color-box color-box_dark-gray'>"+t.rooms+"</a></li>";default:return"<li class='"+a+" entrance-flats__item_not_available'data-image='"+t.img+"'data-square='"+t.all_room+"'data-price_m='"+t.price_m2+"'data-price='"+t.price+"'data-rooms='"+t.rooms+"'data-num='"+t.number+"'><div class='entrance-flats__color-box color-box_gray'></div></li>"}}return 1==t.filter?e(t,"entrance-flats__item"):e(t,"entrance-flats__item entrance-flats__item_active")}function a(t){var e,a="";for(var l in t)a+="<div class='entrance'><p class='entrance__num'>"+l+"</p><div class='entrance-flats-wrap'>"+r(t[l]).floorMarkup+"</div></div>",e=r(t[l]).maxFloor;return{finalMarkup:a,maxFloor:e}}function r(t){var e="",a=0;for(var r in t)a++,e+="<ul class='entrance-flats'>"+l(t[r])+"</ul>";return{floorMarkup:e,maxFloor:a}}function l(t){var a="";for(var r in t)a+=e(t[r]);return a}$(".entrance").remove();var o=t.data;$(".entrance-wrap").append(a(o).finalMarkup),function(t,e){$(".entrance-floor__item").remove();for(var a=+e[0];a<=+e[1];a++)$(".entrance-floor").append("<li class='entrance-floor__item'>"+a+"</li>")}(a(o).maxFloor,t.setka),tooltipShow(),showFlorPlan()}function getParametersFromUrl(){var t=decodeURIComponent(window.location.href),e=t.match(new RegExp("property_","g"));if(null!=e){for(var a=e.length/2||[],r=new URL(t),l={price:r.searchParams.getAll("option[price][]"),all_room:r.searchParams.getAll("option[all_room][]"),rooms:r.searchParams.getAll("option[rooms][]"),floor:r.searchParams.getAll("option[floor][]")},o=0;o<a;o++){var n="property_"+(o+1);n=n.toString(),l[n]=r.searchParams.getAll("option[properties]["+n+"][]")}for(var s=$(".range__item"),i=s.find(".js-filter__hidden-values"),c=0;c<i.length;c++){var u=$(i[c]).attr("name");for(var f in l)if(u==f){var p=$(i[c]).siblings(".js-filter__range").data("ionRangeSlider");p.update({from:l[f][0],to:l[f][1]}),$(i[c]).siblings(".js-filter__text_min").html(l[f][0]),$(i[c]).siblings(".js-filter__text_max").html(l[f][1])}}for(var _=l.rooms,d=$(".filter-short .filter-checkbox"),h=0;h<d.length;h++)_.forEach(function(t,e){+t==h+1&&$(d[h]).attr("checked","checked")})}}$(".filter-top__button_more").on("click",function(){$(this).toggleClass("filter-top__button_more_active"),$(this).find(".filter-top__button-icon").toggleClass("filter-top__button-icon_active"),$(".filter-full").slideToggle(),$(".filter-settings").slideUp()}),$(".filter-full__button_more").on("click",function(){$(this).toggleClass("filter-full__button_more_active"),$(this).find(".filter-full__button-icon").toggleClass("filter-full__button-icon_active"),$(".filter-settings").slideToggle()}),document.querySelectorAll(".color-box").forEach(function(t){var e=t.getAttribute("data-color");"green"==e?$(t).addClass("color-box_green"):"yellow"==e?$(t).addClass("color-box_yellow"):"gray"==e?$(t).addClass("color-box_gray"):"dark-gray"==e&&$(t).addClass("color-box_dark-gray")}),showFlorPlan(),$(".result-short__select").on("click",function(){$(this).siblings(".view-list").slideToggle()}),$(".view-list__item").on("click",function(){var t=$(this).find(".view-list__text").html(),e="#"+$(this).find(".view-list__icon").attr("id"),a=$(this).closest(".result-short__select-wrap").find(".result-short__select-icon");$(this).closest(".result-short__select-wrap").find(".result-short__select").html(t),a.find("use").attr("xlink:href",e),$(this).closest(".view-list").css("display","none");var r=$(this).index();0===r?($(".result-plan").fadeIn(),$(".result-tile-wrap").removeClass("result-tile_active-js").css("display","none"),$(".result-list").css("display","none")):2===r?($(".result-tile-wrap").addClass("result-tile_active-js").fadeIn(),$(".result-list").css("display","none"),$(".result-plan").css("display","none")):1===r&&($(".result-list").fadeIn(),$(".result-tile-wrap").removeClass("result-tile_active-js").css("display","none"),$(".result-plan").css("display","none")),showFilterPagination()}),tooltipShow();var filterDefautl={count:"12",typ:"3",page:"1",order:[],option:{price:getDefaulValue($("input[name='price']")),all_room:getDefaulValue($("input[name='all_room']")),rooms:[],floor:getDefaulValue($("input[name='floor']")),house:$(".building").data("house"),project_id:$(".building").data("id"),properties:{}}};!function(){var t=$(".filter-settings").find(".filter-checkbox");$(".filter-full-range").find(".range__item").remove(),t.each(function(t,e){var a=$(e).prop("checked"),r=$(e).data("label"),l=r.split(" ").join(""),o=$(e).attr("id"),n=$(e).data("min"),s=$(e).data("max");rangeMarkup(l,r,n,s);a&&$(".filter-full-range").append(rangeMarkup(l,o,r,n,s)),addNewOptionToFilter(filterDefautl,o),rangesValue()})}(),$(".filter-settings-list__label").on("click",function(){var t=$(this).siblings(".filter-checkbox"),e=t.prop("checked"),a=t.data("label"),r=a.split(" ").join(""),l=t.attr("id"),o=t.data("min"),n=t.data("max");e?($("#"+r).remove(),filter.option.properties[l][0]=null,filter.option.properties[l][1]=null):($(".filter-full-range").append(rangeMarkup(r,l,a,o,n)),addNewOptionToFilter(filter,l),rangesValue())});var filter=objClone(filterDefautl);!function(){for(var t=filter.option.rooms,e=$(".filter-short-checkbox-wrap").find(".filter-checkbox"),a=0;a<e.length;a++)$(e[a]).prop("checked")&&t.push($(e[a]).attr("value"));console.log(filter)}(),rangesValue(),getRoomsNumber(),$(".filter__button-js").on("click",function(t){t.preventDefault(),$(".residence-list__item").remove();var e=$.param(filter),a=window.location.href+"?";a=a.substr(0,a.indexOf("?")),window.history.pushState("","",a+"?"+e),$.ajax({url:"http://apivime.smarto.com.ua/ajax",type:"POST",dataType:"json",data:filter,success:function(t){console.log(t),entranceShow(t),flatsShow(t.dataList),flatsShowTable(t.dataList,t.dataTable),paginationItemShow(t.quantity,flatsShow,flatsShowTable),$(".result-short_all-js").html(t.quantity),$(".result-short_free-js").html(t.quantityFree)},error:function(t){console.log(t)}})});var tableHeadingCklickCount=1;sendSortingData();var URLSearchParams=URLSearchParams||function(){"use strict";function t(t){var l,n,s,i,c,u,p=Object.create(null);if(this[f]=p,t)if("string"==typeof t)for("?"===t.charAt(0)&&(t=t.slice(1)),i=t.split("&"),c=0,u=i.length;c<u;c++)s=i[c],l=s.indexOf("="),-1<l?a(p,r(s.slice(0,l)),r(s.slice(l+1))):s.length&&a(p,r(s),"");else if(o(t))for(c=0,u=t.length;c<u;c++)s=t[c],a(p,s[0],s[1]);else if(t.forEach)t.forEach(e,p);else for(n in t)a(p,n,t[n])}function e(t,e){a(this,e,t)}function a(t,e,a){var r=o(a)?a.join(","):a;e in t?t[e].push(r):t[e]=[r]}function r(t){return decodeURIComponent(t.replace(i," "))}function l(t){return encodeURIComponent(t).replace(s,u)}var o=Array.isArray,n=t.prototype,s=/[!'\(\)~]|%20|%00/g,i=/\+/g,c={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},u=function(t){return c[t]},f="__URLSearchParams__:"+Math.random();n.append=function(t,e){a(this[f],t,e)},n.delete=function(t){delete this[f][t]},n.get=function(t){var e=this[f];return t in e?e[t][0]:null},n.getAll=function(t){var e=this[f];return t in e?e[t].slice(0):[]},n.has=function(t){return t in this[f]},n.set=function(t,e){this[f][t]=[""+e]},n.forEach=function(t,e){var a=this[f];Object.getOwnPropertyNames(a).forEach(function(r){a[r].forEach(function(a){t.call(e,a,r,this)},this)},this)},n.toJSON=function(){return{}},n.toString=function(){var t,e,a,r,o=this[f],n=[];for(e in o)for(a=l(e),t=0,r=o[e];t<r.length;t++)n.push(a+"="+l(r[t]));return n.join("&")};var p=Object.defineProperty,_=Object.getOwnPropertyDescriptor,d=function(t){function e(e,a){n.append.call(this,e,a),e=this.toString(),t.set.call(this._usp,e?"?"+e:"")}function a(e){n.delete.call(this,e),e=this.toString(),t.set.call(this._usp,e?"?"+e:"")}function r(e,a){n.set.call(this,e,a),e=this.toString(),t.set.call(this._usp,e?"?"+e:"")}return function(t,l){return t.append=e,t.delete=a,t.set=r,p(t,"_usp",{configurable:!0,writable:!0,value:l})}},h=function(t){return function(e,a){return p(e,"_searchParams",{configurable:!0,writable:!0,value:t(a,e)}),a}},m=function(e){var a=e.append;e.append=n.append,t.call(e,e._usp.search.slice(1)),e.append=a},g=function(t,e){if(!(t instanceof e))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+e.name)},v=function(e){var a,r=e.prototype,l=_(r,"searchParams"),o=_(r,"href"),n=_(r,"search");!l&&n&&n.set&&(a=h(d(n)),Object.defineProperties(r,{href:{get:function(){return o.get.call(this)},set:function(t){var e=this._searchParams;o.set.call(this,t),e&&m(e)}},search:{get:function(){return n.get.call(this)},set:function(t){var e=this._searchParams;n.set.call(this,t),e&&m(e)}},searchParams:{get:function(){return g(this,e),this._searchParams||a(this,new t(this.search.slice(1)))},set:function(t){g(this,e),a(this,t)}}}))};return v(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&v(URL),t}();!function(t){var e=function(){try{return!!Symbol.iterator}catch(t){return!1}}();"forEach"in t||(t.forEach=function(t,e){var a=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach(function(r){!r.length||r in a||(a[r]=this.getAll(r)).forEach(function(a){t.call(e,a,r,this)},this)},this)}),"keys"in t||(t.keys=function(){var t=[];this.forEach(function(e,a){t.push(a)});var a={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e&&(a[Symbol.iterator]=function(){return a}),a}),"values"in t||(t.values=function(){var t=[];this.forEach(function(e){t.push(e)});var a={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e&&(a[Symbol.iterator]=function(){return a}),a}),"entries"in t||(t.entries=function(){var t=[];this.forEach(function(e,a){t.push([a,e])});var a={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e&&(a[Symbol.iterator]=function(){return a}),a}),!e||Symbol.iterator in t||(t[Symbol.iterator]=t.entries),"sort"in t||(t.sort=function(){for(var t,e,a,r=this.entries(),l=r.next(),o=l.done,n=[],s=Object.create(null);!o;)a=l.value,e=a[0],n.push(e),e in s||(s[e]=[]),s[e].push(a[1]),l=r.next(),o=l.done;for(n.sort(),t=0;t<n.length;t++)this.delete(n[t]);for(t=0;t<n.length;t++)e=n[t],this.append(e,s[e].shift())})}(URLSearchParams.prototype),getParametersFromUrl();